summarize the aml-tkg workflow. This should include: 

- how the kg is constructed with details on each relation type. 
- how are partitions created, hold out/ cv 
- overview of the two methods used, complex2 and path-gnn 
- other relevant components 

Keep this summary less than 1500 words. DO NOT INVENT MATERIAL. Review the content for details. If uncertain, leave the section blank. 

---

AML-TKG workflow summary

KG construction
- Relations are generated by scripts under `workflow/scripts/` (steps 01 → 10). Each script writes CSVs with columns `src`, `dst`, `src_type`, `dst_type`, `relation` into an output `relations` directory.
- Confirmed relation types and sources:
  - `drug -> targets -> gene` from Targetome/BeatAML curation: `kg_construction_01__drug_interacts_protein.py` writes `targetome_drug_targets_gene_fwd.csv` using filtered DTIs (tiers per `TIERS`, assay types, and assay value thresholds). Drugs are resolved to `inchikey` and SMILES via PubChem. Genes mapped via UniProt symbols.
  - `drug <-> drug` similarity using ChemBERTa embeddings: `kg_construction_02__drug_similar_drug.py` computes cosine similarity over SMILES embeddings and thresholds via quantile or k-NN; outputs `chemberta_drug_cosine_similarity.csv` with `src_type='drug'`, `dst_type='drug'`, `relation='chemberta_cosine_similarity'`.
  - `drug <-> disease` associations (CTD): `kg_construction_03__drug_associates_disease.py` resolves CTD chemicals to `inchikey`, filters to the original targetome drugs, and writes forward and reverse edges: `ctd__drug_disease_association_fwd.csv` (`drug -> associates_fwd -> disease`) and `ctd__drug_disease_association_rev.csv`.
  - `gene <-> disease` associations (CTD): `kg_construction_04__protein_associates_disease.py` writes `ctd_genes_diseases_fwd.csv` (`gene -> associates_fwd -> disease`) and `ctd_genes_diseases_rev.csv`.
  - `gene <-> gene` interactions/regulation (OmniPath): `kg_construction_05__protein_interacts_protein.py` uses OmniPath to create directed edges with relation labels based on consensus: `stimulates_fwd`, `inhibits_fwd`, `interacts_fwd` and corresponding `_rev` files.
  - `gene <-> pathway` membership (CTD): `kg_construction_06__protein_isin_pathway.py` writes `ctd_gene_isin_pathway_fwd.csv` (`gene -> isin_fwd -> pathway`) and `ctd_pathway_isin_gene_rev.csv`.
  - `drug <-> gene` LINCS perturbation by cell line: `kg_construction_07__lincs_drug_perturbed_expression.py` filters to the original Targetome drugs and exemplar 10µM/24h signatures in specific cell lines and writes per-cell relations like `MCF7_lincs_perturbation_fwd.csv` and `_rev.csv`.
  - `gene <-> gene` similarity (ProtBert): `kg_construction_08a__embed_amino_acids.py` embeds sequences for genes present in the relations; `kg_construction_08b__protein_protein_similarity.py` thresholds cosine similarity and writes `protbert__gene_gene_similarity.csv` with `relation='protbert_similarity'` (both directions written).
  - Predicted binding affinity (external model): `kg_construction_09d__predicted_binding_affinity.py` filters predictions to original Targetome drugs and exports strong binders as `jglaser__predicted_strong_binding_fwd.csv` (`drug -> predicted_strong_binding_fwd -> gene`) and `_rev`.
  - Final TKG assembly: `kg_construction_10_make_tkg.py` collects relation CSVs from `extdata/relations`, optionally filters out reverse relations and patient-related relations, and excludes several relation patterns per ablation list: `gene->mut_missense_variant_deleterious_rev->dbgap_subject`, `gene->isin_fwd->pathway`, `gene->associates_fwd->disease`, `gene->A549_lincs_perturbation_rev->drug`.
- Graph building details: `tkgdti/data/GraphBuilder.py` reads all relation CSVs, indexes nodes per `src_type`/`dst_type`, constructs `edge_index_dict` keyed by `(src_type, relation, dst_type)`, `num_nodes_dict`, and `edge_reltype` mapping relation keys to integer ids. Output is a PyTorch Geometric `HeteroData` with these dictionaries.

Partitions, hold-out, and cross-validation
- `kg_construction_10_make_tkg.py` performs K-fold cross-validation over the target DTI set only. All auxiliary relations remain in training for every fold.
  - The target file is read from the relations directory (`targetome_drug_targets_gene.csv` or `targetome_drug_targets_gene_fwd.csv`) after dropping rows with missing fields; its row count defines the number of DTIs, N.
  - K-folds: `KFold(n_splits=k_folds, random_state=seed, shuffle=True)` splits indices `[0..N-1]` into `train_idxs` and `test_idxs` for each fold.
  - Validation split: a subset of `train_idxs` of size `val_prop * len(train_idxs)` is sampled without replacement to form `val_idxs`; remaining are used as final `train_idxs`. Assertions ensure no overlap between train/val/test.
  - For each fold, `GraphBuilder` is invoked with `val_idxs` and `test_idxs`; `get_triples()` returns per-partition positive triples (`pos_train.pt`, `pos_valid.pt`, `pos_test.pt`) and the heterogeneous graph (`Data.pt`). Deprecated negative files are saved as `None`.
  - The script computes and logs graph metrics: total nodes/edges, node counts per type, and edge counts per relation, and saves under `.../processed/FOLD_{i}`.

Methods overview
- ComplEx2: Implemented in `tkgdti/models/ComplEx2.py` as a heterogenous adaptation of ComplEx^2.
  - Embeddings: separate real/imaginary head and tail embeddings per node type, and real/imaginary relation embeddings.
  - Scoring: uses a complex-valued tri-linear interaction with a partition function that enables normalized log-probabilities per relation type `(head_type, relation, tail_type)`; dropout masks can be applied per-node-type weights. Training/evaluation utilities are in `tkgdti/train/train_gekc.py` and launched via `workflow/scripts/train_complex2.py`.
- Path-GNN: Implemented as a diffusion-like path-based GNN for explainable DTI prediction.
  - Model: `tkgdti/models/GNN.py` stacks configurable graph convolution layers (e.g., GAT variants), with edge-type embeddings, optional residuals, normalization, and dropout; final MLP outputs per-node scores.
  - Data encoding and rationale are described in `docs/gnn.md`: a single drug node is activated, and convolutions diffuse signals through heterogeneous edges to produce drug-specific protein scores; predictions are formulated as node classification over proteins rather than link prediction.
  - Training entrypoint: `workflow/scripts/train_gnn.py` calls `tkgdti/train/train_gnn.py`, which builds the model with parameters (channels, layers, heads, dropout, norm, conv type), optimizes with Adam, and evaluates using metrics such as MRR, Top@K, and AUROC.

Other relevant components
- Embeddings and utilities:
  - Drug embeddings (ChemBERTa) via `tkgdti/embed/SMILES2EMB.py` used in step 02.
  - Protein embeddings (ProtBert/ESM2 optional in config) via `tkgdti/embed/AA2EMB.py` used in steps 08a/08b.
- Workflow orchestration: `workflow/aml-tkg/Snakefile` and `workflow/aml-tkg/config.yaml` define directories, experiment id/seed, and per-step parameters (e.g., LINCS cell lines, thresholds, similarity quantiles). The Snakefile sequences steps 01 → 09d and manages outputs under an experiment root.
- Training scripts: `workflow/scripts/train_complex2.py` and `workflow/scripts/train_gnn.py` configure and launch model training on processed folds.